{"version":3,"sources":["webpack:///src/views/modules/area-administrator/allot-area-dialog.vue","webpack:///./src/views/modules/area-administrator/allot-area-dialog.vue?19c2","webpack:///./src/views/modules/area-administrator/allot-area-dialog.vue"],"names":["allot_area_dialog","name","props","components","orgTree","computed","filtersDataList","this","dataList","filter","item","sysStsatus","data","roleId","checkedAll","checkStrictly","treeData","treeCheckBox","defaultChecked","sysId","activeName","$store","state","common","areaSysId","treeIds","treeLoading","watch","created","sysDataList","id","getData","methods","handleCheck","bol","$refs","tree","setCheckedNodes","check","currentObj","treeStatus","restAllChecked","checkedKeys","indexOf","selectedParent","uniteChildSame","children","length","_this","$http","url","adornUrl","API","getAllApplySystemInfoSystem","method","adornData","searchCount","then","res","resData","code","$message","error","msg","handleClick","tab","_this2","getMenuTreetBysIdMenu","areaId","checkedData","_ref","getIsCheckCurrent","getCurrentKey","_this3","batchInsertSysAreaMenuArea","menuId","getCheckedKeys","join","_ref2","success","$emit","arr","_this4","setCheckedKeys","getChild","forEach","push","isCheck","treeList","isSelected","_this5","setChecked","index","currentNode","getNode","console","log","undefined","parent","key","crruntCheckedIdsLen","area_administrator_allot_area_dialog","render","_vm","_h","$createElement","_c","_self","attrs","type","on","tab-click","model","value","callback","$$v","expression","_l","label","sysName","_v","staticClass","change","size","click","directives","rawName","staticStyle","height","ref","checkbox","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"mIAkBAA,GACAC,KAAA,oBACAC,OACA,eAEAC,YACAC,kBAAA,GAEAC,UACAC,gBADA,WAEA,OAAAC,KAAAC,SAAAC,OAAA,SAAAC,GAAA,YAAAA,EAAAC,eAGAC,KAbA,WAcA,OACAC,OAAA,GACAC,YAAA,EACAC,eAAA,EACAC,YACAC,cAAA,EACAC,kBACAV,YACAW,MAAA,GACAC,WAAAb,KAAAc,OAAAC,MAAAC,OAAAC,UACAC,WACAC,aAAA,IAGAC,SACAC,QA7BA,WA8BArB,KAAAsB,cACA,IAAAC,EAAAvB,KAAAc,OAAAC,MAAAC,OAAAC,UACAjB,KAAAwB,QAAAD,IAEAE,SAEAC,YAFA,SAEAC,GACA3B,KAAAO,WAAAoB,EACAA,EACA3B,KAAA4B,MAAAC,KAAAC,gBAAA9B,KAAAS,UAEAT,KAAA4B,MAAAC,KAAAC,qBAIAC,MAXA,SAWAC,EAAAC,GACAjC,KAAAkC,kBAIA,IAFAD,EAAAE,YAAAC,QAAAJ,EAAAT,KAIAvB,KAAAqC,eAAAL,GAEAhC,KAAAsC,eAAAN,GAAA,IAGA,IAAAA,EAAAO,SAAAC,QACAxC,KAAAsC,eAAAN,GAAA,IAIAV,YA5BA,WA4BA,IAAAmB,EAAAzC,KACAA,KAAA0C,OACAC,IAAA3C,KAAA0C,MAAAE,SAAA5C,KAAA6C,IAAAC,6BACAC,OAAA,OACA1C,KAAAL,KAAA0C,MAAAM,WACAC,aAAA,MAEAC,KAAA,SAAAC,GACA,IAAAC,EAAAD,EAAA9C,KACA,IAAA+C,EAAAC,KACAZ,EAAAxC,SAAAmD,EAAA/C,MAEAoC,EAAAa,SAAAC,MAAAH,EAAAI,KACAf,EAAAxC,gBAIAwD,YA7CA,SA6CAC,GACA1D,KAAAY,MAAA8C,EAAAhE,KACAM,KAAAwB,QAAAxB,KAAAY,QAEAY,QAjDA,SAiDAD,GAAA,IAAAoC,EAAA3D,KACAA,KAAAkB,WACAlB,KAAA0C,OACAC,IAAA3C,KAAA0C,MAAAE,SAAA5C,KAAA6C,IAAAe,uBACAb,OAAA,OACA1C,KAAAL,KAAA0C,MAAAM,WACApC,MAAAW,EACAsC,OAAA7D,KAAA8D,YAAAD,WAEAX,KAAA,SAAAa,GAAA,IAAA1D,EAAA0D,EAAA1D,KACAA,GAAA,IAAAA,EAAAgD,MACAM,EAAAlD,SAAAJ,OACAsD,EAAAhD,eAAAgD,EAAAK,kBAAA3D,QACAsD,EAAAxC,aAAA,IAEAwC,EAAAL,SAAAC,MAAAlD,EAAAmD,KACAG,EAAAlD,YACAkD,EAAAhD,kBACAgD,EAAAxC,aAAA,MAIA8C,cAvEA,WAuEA,IAAAC,EAAAlE,KAEAA,KAAA0C,OACAC,IAAA3C,KAAA0C,MAAAE,SAAA5C,KAAA6C,IAAAsB,4BACApB,OAAA,OACA1C,KAAAL,KAAA0C,MAAAM,WACAa,OAAA7D,KAAA8D,YAAAD,OACAjD,MAAAZ,KAAAY,OAAAZ,KAAAc,OAAAC,MAAAC,OAAAC,UACAmD,OAAApE,KAAA4B,MAAAC,KAAAwC,iBAAAC,KAAA,SAEApB,KAAA,SAAAqB,GAAA,IAAAlE,EAAAkE,EAAAlE,KACAA,GAAA,IAAAA,EAAAgD,MACAa,EAAAZ,SAAAkB,QAAA,QACAN,EAAAO,MAAA,eAEAP,EAAAZ,SAAAC,MAAAlD,EAAAmD,QAIAQ,kBA1FA,SA0FAU,GAAA,IAAAC,EAAA3E,KACA4E,KACA,GAAAF,EAAA,CAYA,OAXA,SAAAG,EAAAH,GASA,OARAA,EAAAI,QAAA,SAAA3E,GACAwE,EAAAzD,QAAA6D,KAAA5E,EAAAoB,IACApB,EAAA6E,SAAAJ,EAAAG,KAAA5E,EAAAoB,IACApB,EAAA,UAAAA,EAAA,SAAAqC,OAAA,GACAqC,EAAA1E,EAAAoC,YAGAoC,EAAApE,WAAAqE,EAAApC,SAAAmC,EAAAzD,QAAAsB,QAAAmC,EAAAzD,QAAAsB,OAAA,EACAoC,EAEAC,CAAAH,KAGApC,eA3GA,SA2GA2C,EAAAC,GAAA,IAAAC,EAAAnF,KACAA,KAAA4B,MAAAC,KAAAuD,WAAAH,EAAA1D,GAAA2D,GACAD,EAAA1C,SAAAuC,QAAA,SAAA3E,EAAAkF,GACAF,EAAA7C,eAAA2C,EAAA1C,SAAA8C,GAAAH,MAIA7C,eAlHA,SAkHAL,GACA,IAAAsD,EAAAtF,KAAA4B,MAAAC,KAAA0D,QAAAvD,GACAwD,QAAAC,IAAAH,QACAI,IAAAJ,EAAAK,OAAAC,MACA5F,KAAA4B,MAAAC,KAAAuD,WAAAE,EAAAK,QAAA,GACA3F,KAAAqC,eAAAiD,EAAAK,UAIAzD,eA3HA,WA4HA,IAAA2D,EAAA7F,KAAA4B,MAAAC,KAAAwC,iBAAA7B,OACAgD,QAAAC,IAAAI,GACA7F,KAAAO,WAAAsF,IAAA7F,KAAAkB,QAAAsB,UC/KesD,GADEC,OAFjB,WAA0B,IAAAC,EAAAhG,KAAaiG,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,WAA+BE,OAAOC,KAAA,QAAcC,IAAKC,YAAAR,EAAAvC,aAA4BgD,OAAQC,MAAAV,EAAA,WAAAW,SAAA,SAAAC,GAAgDZ,EAAAnF,WAAA+F,GAAmBC,WAAA,eAA0Bb,EAAAc,GAAAd,EAAA,yBAAA7F,EAAAkF,GAAmD,OAAAc,EAAA,eAAyBP,IAAAP,EAAAgB,OAAiBU,MAAA5G,EAAA6G,QAAAtH,KAAAS,EAAAS,WAA0C,GAAAoF,EAAAiB,GAAA,KAAAd,EAAA,OAA2Be,YAAA,gBAA0Bf,EAAA,eAAoBI,IAAIY,OAAAnB,EAAAtE,aAAyB+E,OAAQC,MAAAV,EAAA,WAAAW,SAAA,SAAAC,GAAgDZ,EAAAzF,WAAAqG,GAAmBC,WAAA,gBAA0Bb,EAAAiB,GAAA,WAAAjB,EAAAiB,GAAA,KAAAd,EAAA,aAAgDE,OAAOC,KAAA,UAAAc,KAAA,SAAgCb,IAAKc,MAAArB,EAAA/B,iBAA2B+B,EAAAiB,GAAA,YAAAjB,EAAAiB,GAAA,KAAAd,EAAA,OAA2Ce,YAAA,aAAuBlB,EAAAiB,GAAA,KAAAd,EAAA,gBAAiCmB,aAAa5H,KAAA,UAAA6H,QAAA,YAAAb,MAAAV,EAAA,YAAAa,WAAA,gBAAoFW,aAAeC,OAAA,WAAkBtB,EAAA,YAAiBuB,IAAA,OAAArB,OAAkB5F,SAAAuF,EAAAvF,SAAAkH,SAAA3B,EAAAtF,aAAAF,cAAAwF,EAAAxF,cAAAG,eAAAqF,EAAArF,gBAA0H4F,IAAKxE,MAAAiE,EAAAjE,UAAmB,QAErmC6F,oBCCjB,IAcAC,EAdyBC,EAAQ,OAcjCC,CACEtI,EACAqG,GATF,EAVA,SAAAkC,GACEF,EAAQ,SAaV,kBAEA,MAUeG,EAAA,QAAAJ,EAAiB","file":"static/js/56.7523a2aa66cdb1b534c6.js","sourcesContent":["<template>\r\n  <div>\r\n    <el-tabs v-model=\"activeName\" type=\"card\" @tab-click=\"handleClick\">\r\n      <el-tab-pane v-for=\"(item, index) in filtersDataList\" :key=\"index\" :label=\"item.sysName\" :name=\"item.sysId\"></el-tab-pane>\r\n    </el-tabs>\r\n    <div class=\"float-right\">\r\n      <el-checkbox v-model=\"checkedAll\" @change=\"handleCheck\">关联子节点</el-checkbox>\r\n      <el-button type=\"primary\" size=\"small\" @click=\"getCurrentKey\">保存</el-button>\r\n    </div>\r\n    <div class=\"clearfix\"></div>\r\n    <el-scrollbar style='height: 400px;' v-loading=\"treeLoading\">\r\n      <org-tree ref=\"tree\" :treeData=\"treeData\" :checkbox=\"treeCheckBox\" :checkStrictly=\"checkStrictly\" :defaultChecked=\"defaultChecked\" @check=\"check\"></org-tree>\r\n    </el-scrollbar>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport orgTree from \"@/components/baseComponents/orgTree.vue\";\r\nexport default {\r\n  name: 'allot-area-dialog',\r\n  props: [\r\n    'checkedData'\r\n  ],\r\n  components: {\r\n    orgTree\r\n  },\r\n  computed: {\r\n    filtersDataList () {\r\n      return this.dataList.filter(item => item.sysStsatus === '1')\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      roleId: '',\r\n      checkedAll: false,\r\n      checkStrictly: false,\r\n      treeData: [],\r\n      treeCheckBox: true,//tree复选框是否有\r\n      defaultChecked: [],\r\n      dataList: [],//机构数据\r\n      sysId: '',//机构id\r\n      activeName: this.$store.state.common.areaSysId,\r\n      treeIds: [], // 所有树ID 用于统计当前树节点个数\r\n      treeLoading: true\r\n    }\r\n  },\r\n  watch: {},\r\n  created () {\r\n    this.sysDataList();\r\n    var id = this.$store.state.common.areaSysId;\r\n    this.getData(id);\r\n  },\r\n  methods: {\r\n    // 当前点击的对象\r\n    handleCheck (bol) {\r\n      this.checkedAll = bol\r\n      if (bol) {\r\n        this.$refs.tree.setCheckedNodes(this.treeData);\r\n      } else {\r\n        this.$refs.tree.setCheckedNodes([]);\r\n      }\r\n    },\r\n    // 获取当前点击的checkbox的对象\r\n    check (currentObj, treeStatus) {\r\n      this.restAllChecked()\r\n      // // 用于：父子节点严格互不关联时，父节点勾选变化时通知子节点同步变化，实现单向关联。\r\n      let selected = treeStatus.checkedKeys.indexOf(currentObj.id); // -1未选中\r\n      // // 选中\r\n      if (selected !== -1) {\r\n        // 子节点只要被选中父节点就被选中\r\n        this.selectedParent(currentObj)\r\n        // 统一处理子节点为相同的勾选状态\r\n        this.uniteChildSame(currentObj, true)\r\n      } else {\r\n        // 未选中 处理子节点全部未选中\r\n        if (currentObj.children.length !== 0) {\r\n          this.uniteChildSame(currentObj, false)\r\n        }\r\n      }\r\n    },\r\n    sysDataList () {\r\n      this.$http({\r\n        url: this.$http.adornUrl(this.API.getAllApplySystemInfoSystem),\r\n        method: 'post',\r\n        data: this.$http.adornData({\r\n          searchCount: false, //分页默认true，不需要传false\r\n        })\r\n      }).then((res) => {\r\n        var resData = res.data;\r\n        if (resData.code === 0) {\r\n          this.dataList = resData.data;\r\n        } else {\r\n          this.$message.error(resData.msg);\r\n          this.dataList = [];\r\n        }\r\n      })\r\n    },\r\n    handleClick (tab) {\r\n      this.sysId = tab.name;\r\n      this.getData(this.sysId)\r\n    },\r\n    getData (id) {\r\n      this.treeIds = [];\r\n      this.$http({\r\n        url: this.$http.adornUrl(this.API.getMenuTreetBysIdMenu),\r\n        method: 'post',\r\n        data: this.$http.adornData({\r\n          sysId: id,\r\n          areaId: this.checkedData.areaId,\r\n        })\r\n      }).then(({ data }) => {\r\n        if (data && data.code === 0) {\r\n          this.treeData = data.data;\r\n          this.defaultChecked = this.getIsCheckCurrent(data.data);\r\n          this.treeLoading = false;\r\n        } else {\r\n          this.$message.error(data.msg);\r\n          this.treeData = [];\r\n          this.defaultChecked = [];\r\n          this.treeLoading = false;\r\n        }\r\n      });\r\n    },\r\n    getCurrentKey () { //保存选中节点\r\n      // console.log(this.$refs.tree.getCheckedKeys().concat(this.$refs.tree.getHalfCheckedKeys()).join(','))\r\n      this.$http({\r\n        url: this.$http.adornUrl(this.API.batchInsertSysAreaMenuArea),\r\n        method: 'post',\r\n        data: this.$http.adornData({\r\n          areaId: this.checkedData.areaId, //区域id\r\n          sysId: this.sysId || this.$store.state.common.areaSysId, //系统id\r\n          menuId: this.$refs.tree.getCheckedKeys().join(','),//菜单id\r\n        })\r\n      }).then(({ data }) => {\r\n        if (data && data.code === 0) {\r\n          this.$message.success('操作成功');\r\n          this.$emit(\"addback\", true);\r\n        } else {\r\n          this.$message.error(data.msg);\r\n        }\r\n      });\r\n    },\r\n    getIsCheckCurrent (arr) { //多层树结构中取出是否选中\r\n      const setCheckedKeys = [];\r\n      if (!arr) return;\r\n      const getChild = (arr) => {\r\n        arr.forEach(item => {\r\n          this.treeIds.push(item.id)\r\n          if (item.isCheck) setCheckedKeys.push(item.id);\r\n          if (item['children'] && item['children'].length > 0) {\r\n            getChild(item.children)\r\n          }\r\n        })\r\n        this.checkedAll = (setCheckedKeys.length === this.treeIds.length && this.treeIds.length > 0 ? true : false)\r\n        return setCheckedKeys;\r\n      }\r\n      return getChild(arr)\r\n    },\r\n    // 统一处理子节点为相同的勾选状态\r\n    uniteChildSame (treeList, isSelected) {\r\n      this.$refs.tree.setChecked(treeList.id, isSelected)\r\n      treeList.children.forEach((item, index) => {\r\n        this.uniteChildSame(treeList.children[index], isSelected)\r\n      })\r\n    },\r\n    // 统一处理父节点为选中\r\n    selectedParent (currentObj) {\r\n      let currentNode = this.$refs.tree.getNode(currentObj)\r\n      console.log(currentNode)\r\n      if (currentNode.parent.key !== undefined) {\r\n        this.$refs.tree.setChecked(currentNode.parent, true)\r\n        this.selectedParent(currentNode.parent)\r\n      }\r\n    },\r\n    // 重置全选状态\r\n    restAllChecked () {\r\n      const crruntCheckedIdsLen = this.$refs.tree.getCheckedKeys().length;\r\n      console.log(crruntCheckedIdsLen)\r\n      this.checkedAll = (crruntCheckedIdsLen === this.treeIds.length ? true : false)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.float-right {\r\n  padding-bottom: 10px;\r\n  margin-top: 10px;\r\n  .el-checkbox {\r\n    padding-right: 20px;\r\n  }\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/modules/area-administrator/allot-area-dialog.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-tabs',{attrs:{\"type\":\"card\"},on:{\"tab-click\":_vm.handleClick},model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},_vm._l((_vm.filtersDataList),function(item,index){return _c('el-tab-pane',{key:index,attrs:{\"label\":item.sysName,\"name\":item.sysId}})}),1),_vm._v(\" \"),_c('div',{staticClass:\"float-right\"},[_c('el-checkbox',{on:{\"change\":_vm.handleCheck},model:{value:(_vm.checkedAll),callback:function ($$v) {_vm.checkedAll=$$v},expression:\"checkedAll\"}},[_vm._v(\"关联子节点\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.getCurrentKey}},[_vm._v(\"保存\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"clearfix\"}),_vm._v(\" \"),_c('el-scrollbar',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.treeLoading),expression:\"treeLoading\"}],staticStyle:{\"height\":\"400px\"}},[_c('org-tree',{ref:\"tree\",attrs:{\"treeData\":_vm.treeData,\"checkbox\":_vm.treeCheckBox,\"checkStrictly\":_vm.checkStrictly,\"defaultChecked\":_vm.defaultChecked},on:{\"check\":_vm.check}})],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-4b29ab0c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/views/modules/area-administrator/allot-area-dialog.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4b29ab0c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./allot-area-dialog.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./allot-area-dialog.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./allot-area-dialog.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4b29ab0c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./allot-area-dialog.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4b29ab0c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/modules/area-administrator/allot-area-dialog.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}