webpackJsonprmsh([78],{GOp8:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={components:{orgTree:a("HMPb").a},data:function(){return{visible:!1,treeData:[],expandAll:!0,sysId:"",userId:"",dataList:[],dataListLoading:!1,multipleSelection:[]}},methods:{init:function(e){this.visible=!0,this.userId=e,this.getDataTree()},getDataTree:function(){var e=this;this.$http({url:this.$http.adornUrl(this.API.getRoleMenuTree),method:"post",data:this.$http.adornData({areaId:this.$store.state.user.areaId})}).then(function(t){var a=t.data;if(a&&0===a.code){var r=[];a.data.length>0&&(a.data.forEach(function(e){r.push({name:e.sysName,id:e.sysId})}),e.treeData=[{name:"应用子系统",children:r}],e.orgTreeClick(e.treeData[0].children[0]))}else e.$message.error(a.msg),e.treeData=[]})},orgTreeClick:function(e){this.sysId=e.id,this.getDataList()},getDataList:function(){var e=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl(this.API.getRoleInfoByUserId),method:"post",data:this.$http.adornData({sysId:this.sysId,areaId:this.$store.state.user.areaId,userId:this.userId,searchCount:!1,relateType:"0",relateId:this.userId})}).then(function(t){var a=t.data;a&&0===a.code?(e.dataList=a.data.records,e.$nextTick(function(){e.dataList.forEach(function(t){null!=t.relateId&&""!=t.relateId&&e.$refs.table.toggleRowSelection(t,!0)})})):(e.$message.error(a.msg),e.dataList=[]),e.dataListLoading=!1})},handleSelectionChange:function(e){var t=this;this.multipleSelection=[],e.forEach(function(e){t.multipleSelection.push(e.roleId)})},saveHandle:function(){var e=this;this.$http({url:this.$http.adornUrl(this.API.saveRoleuser),method:"post",data:this.$http.adornData({areaId:this.$store.state.user.areaId,roleId:this.multipleSelection.join(","),relateId:this.userId,relateType:"0"})}).then(function(t){var a=t.data;a&&0===a.code?e.$message.success("操作成功"):e.$message.error(a.msg)})}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"grant-authorization",attrs:{title:"授权","close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[a("el-container",[a("el-aside",{attrs:{width:"30%"}},[a("el-scrollbar",{staticStyle:{height:"400px"}},[a("org-tree",{ref:"tree",attrs:{treeData:e.treeData,expandAll:e.expandAll},on:{"node-click":e.orgTreeClick}})],1)],1),e._v(" "),a("el-main",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading,expression:"dataListLoading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",height:"400px"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"40"}}),e._v(" "),a("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleCode",width:"100",label:"角色代码"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleType",width:"100",label:"角色类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===parseInt(t.row.roleType)?a("div",[e._v("系统管理员")]):e._e(),e._v(" "),2===parseInt(t.row.roleType)?a("div",[e._v("安全保密员")]):e._e(),e._v(" "),3===parseInt(t.row.roleType)?a("div",[e._v("安全审计员")]):e._e(),e._v(" "),4===parseInt(t.row.roleType)?a("div",[e._v("业务管理员")]):e._e()]}}])})],1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.saveHandle}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var i=a("C7Lr")(r,s,!1,function(e){a("zjoF")},"data-v-0e95a9f0",null);t.default=i.exports},zjoF:function(e,t){}});
//# sourceMappingURL=78.8277976f2ef5d79de7fe.js.map