webpackJsonprmsh([11,15],{"8exI":function(e,t){},OXOJ:function(e,t){},QHpi:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("3cXf"),s=r.n(a),n=r("hQpW"),i=r("TG8v"),o=r("0xDb"),l={name:"userManage",components:{organizationTreeSelect:n.a,userUpdate:i.default},props:["siteContentViewHeight"],data:function(){return{Height:{height:document.documentElement.clientHeight-200+"px"},userUpdateVisable:!1,dialogTitle:"",search:{org:"",code:"",name:""},treeData:[],nodeId:"",tableData:[],currentRow:{},isEdit:!0,keyWord:"",page:{pageNum:1,pageSize:10,pageSizes:[10,20,30,40,50],total:0},flag:!1}},created:function(){this.getUserData()},methods:{orgTreeSelectCall:function(e){console.log(e),this.search.org=e?e.id:""},indexMethod:function(e){return e+1},getUserData:function(){var e=this;e.$http({url:e.$http.adornUrl(e.API.getSysPoweruser),method:"post",data:e.$http.adornData({orgId:e.search.org,userCode:e.search.code,userName:e.search.name})}).then(function(t){var r=t.data;0===r.code?e.tableData=r.data.records:e.$message.error(res.msg)}).catch(function(t){e.$message.error(t)})},handleSizeChange:function(e){this.page.pageSize=e,this.getUserData()},handleCurrentChange:function(e){this.page.pageNum=e,this.getUserData()},searchUser:function(){this.getUserData()},addUser:function(){this.currentRow.orgId=this.nodeId,this.dialogTitle="添加用户",this.userUpdateVisable=!0,this.isEdit=!1},updateUser:function(e){this.currentRow=e,this.dialogTitle="编辑用户",this.userUpdateVisable=!0,this.isEdit=!0},updateCallback:function(e){e&&this.getUserData(),this.userUpdateVisable=!1},delUser:function(e){var t=this;this.$confirm("确定删除本条数据？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http({url:t.$http.adornUrl(t.API.deleteSysPoweruser),method:"post",data:t.$http.adornData({userId:e.userId})}).then(function(e){0===e.data.code?(t.$message.success("删除成功"),t.getUserData()):t.$message.error("删除失败")}).catch(function(e){})})},unlockUser:function(e){var t=this;this.$confirm("确定解锁吗？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http({url:t.$http.adornUrl(t.API.unlock),method:"post",data:t.$http.adornData({userId:e.userId})}).then(function(e){var r=e.data;0===r.code?t.$message.success(r.msg):t.$message.error("重置失败")}).catch(function(e){})})},resetPassword:function(e){var t=this;this.$confirm("确定初始化密码吗？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http({url:t.$http.adornUrl(t.API.initPassword),method:"post",data:t.$http.adornData({userId:e.userId})}).then(function(e){var r=e.data;0===r.code?t.$message.success(r.msg):t.$message.error("重置失败")}).catch(function(e){})})},selectionChangeHandle:function(e){this.tableDataSelections=e},moveDirection:function(e){var t,r=this;r.tableDataSelections.sort(function(e,t){return r.tableData.indexOf(e)-r.tableData.indexOf(t)}),"down"==e&&r.tableDataSelections.reverse(),r.tableDataSelections.forEach(function(a){t=r.tableData.indexOf(a),"up"==e?r.moveUp(t):"down"==e&&r.moveDown(t)})},moveUp:function(e){0!=e&&(this.tableData=Object(o.d)(this.tableData,e,e-1,"up"))},moveDown:function(e){e!=this.tableData.length-1&&(this.tableData=Object(o.d)(this.tableData,e,e+1,"down"))},saveSort:function(){var e=this,t=[];this.tableData.length<0||(this.tableData.forEach(function(e,r){t.push({userId:e.userId,orderno:r+1})}),this.$http({url:this.$http.adornUrl(this.API.userSort),method:"post",data:this.$http.adornData({data:s()(t)})}).then(function(t){var r=t.data;r&&0===r.code?(e.getUserData(),e.$message.success("操作成功")):e.$message.error(r.msg)}))}},watch:{filterText:function(e){this.$refs.orgTree.filter(e)},fullHeight:function(e){if(!this.timer){this.fullHeight=e,this.timer=!0;var t=this;setTimeout(function(){t.timer=!1},400)}}},mounted:function(){var e=this;window.onresize=function(){return window.fullHeight=document.documentElement.clientHeight,void(e.fullHeight=window.fullHeight)}}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"userManage"},[r("el-container",{staticStyle:{height:"100%"}},[r("el-main",[r("div",{staticClass:"search table-header-btn"},[r("div",{staticClass:"table-header-btn-l"},[r("span",{staticClass:"labelName"},[e._v("机构")]),e._v(" "),r("organizationTreeSelect",{attrs:{defaultOptions:e.search.org},on:{OrgTreeSelectCall:e.orgTreeSelectCall}}),e._v(" "),r("span",{staticClass:"labelName"},[e._v("登录名")]),e._v(" "),r("el-input",{attrs:{size:"small",placeholder:"登录名",clearable:!0},model:{value:e.search.code,callback:function(t){e.$set(e.search,"code",t)},expression:"search.code"}}),e._v(" "),r("span",{staticClass:"labelName"},[e._v("姓名")]),e._v(" "),r("el-input",{attrs:{size:"small",placeholder:"姓名",clearable:!0},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}}),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.searchUser}},[e._v("查询")])],1),e._v(" "),r("div",{staticClass:"table-header-btn-r"},[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addUser}},[e._v("添加")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.moveDirection("up")}}},[e._v("上移")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.moveDirection("down")}}},[e._v("下移")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveSort}},[e._v("保存排序")])],1)]),e._v(" "),r("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",height:e.siteContentViewHeight-104+"px"},on:{"selection-change":e.selectionChangeHandle}},[r("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{width:"50px",fixed:"",type:"index",index:e.indexMethod,label:"序号",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"userCode",label:"登录名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"userName",label:"用户名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"userType",label:"用户类型"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"==t.row.userType?r("div",[e._v("部门")]):"1"==t.row.userType?r("div",[e._v("单位")]):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"userPhone",label:"用户电话"}}),e._v(" "),r("el-table-column",{attrs:{prop:"userEmail",label:"用户邮箱"}}),e._v(" "),r("el-table-column",{attrs:{prop:"userStatus",label:"用户状态"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"==t.row.userStatus?r("el-tag",{attrs:{size:"medium",type:"danger"}},[e._v("禁用")]):"1"==t.row.userStatus?r("el-tag",{attrs:{size:"medium",type:"success"}},[e._v("启用")]):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"350px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini",plain:"",title:"初始化密码"},on:{click:function(r){return e.resetPassword(t.row,t.$index)}}},[e._v("初始化密码")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"mini",plain:"",title:"解锁"},on:{click:function(r){return e.unlockUser(t.row,t.$index)}}},[e._v("解锁")]),e._v(" "),r("el-button",{attrs:{size:"mini",plain:"",type:"primary",title:"编辑"},on:{click:function(r){return e.updateUser(t.row,t.$index)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{title:"删除",size:"mini",plain:"",type:"danger"},on:{click:function(r){return e.delUser(t.row,t.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("el-pagination",{attrs:{"current-page":e.page.pageNum,"page-sizes":e.page.pageSizes,"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),e.userUpdateVisable?r("el-dialog",{attrs:{title:e.dialogTitle,visible:e.userUpdateVisable,"close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(t){e.userUpdateVisable=t}}},[r("user-update",{attrs:{currentRow:e.currentRow,isEdit:e.isEdit},on:{updateCallback:e.updateCallback}})],1):e._e()],1)],1)],1)},staticRenderFns:[]};var c=r("C7Lr")(l,u,!1,function(e){r("OXOJ")},"data-v-20c94d43",null);t.default=c.exports},TG8v:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"userUpdate",props:["isEdit","currentRow"],components:{organizationTreeSelect:r("hQpW").a},data:function(){return{rules:{userCode:[{required:!0,message:"请输入登录名",tigger:"change"},{min:3,max:20,message:"长度在 3 到 20个字符",trigger:"blur"}],userName:[{required:!0,message:"请输入用户名",tigger:"change"},{min:3,max:20,message:"长度在 3 到 20个字符",trigger:"blur"}]},userForm:{orgId:"",userId:"",userCode:"",userName:"",userStatus:"",userEmail:"",userPhone:"",userType:""},formLabelWidth:"110px",flag:!1}},created:function(){this.isEdit&&(this.userForm.orgId=this.currentRow.orgId,this.userForm.userId=this.currentRow.userId,this.userForm.userCode=this.currentRow.userCode,this.userForm.userName=this.currentRow.userName,this.userForm.userStatus=this.currentRow.userStatus,this.userForm.userType=this.currentRow.userType,this.userForm.userEmail=this.currentRow.userEmail,this.userForm.userPhone=this.currentRow.userPhone)},methods:{orgTreeSelectCall:function(e){this.userForm.orgId=e?e.id:""},saveUserManage:function(e){var t=this;this.$refs.userForm.validate(function(r){if(!r)return!1;var a=t,s="";s=a.currentRow.userId?a.API.updateSysPoweruser:a.API.insertSysPoweruser,a.$http({url:a.$http.adornUrl(s),method:"post",data:a.$http.adornData(e)}).then(function(e){0===e.data.code?(a.$message.success("操作成功"),t.$emit("updateCallback",!0)):a.$message.error("操作失败，请重新尝试")}).catch(function(e){})})},resetForm:function(e){var t=this;this.$nextTick(function(){void 0!==t.$refs[e]&&t.$refs[e].resetFields()})}}},s={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user-update"},[r("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.rules,size:"small"}},[r("el-form-item",{attrs:{label:"机构选择","label-width":e.formLabelWidth,prop:" orgId"}},[r("organizationTreeSelect",{attrs:{defaultOptions:e.userForm.orgId},on:{OrgTreeSelectCall:e.orgTreeSelectCall}})],1),e._v(" "),r("el-form-item",{attrs:{label:"登录名称","label-width":e.formLabelWidth,prop:"userCode"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.userForm.userCode,callback:function(t){e.$set(e.userForm,"userCode",t)},expression:"userForm.userCode"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户名称","label-width":e.formLabelWidth,prop:"userName"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.userForm.userName,callback:function(t){e.$set(e.userForm,"userName",t)},expression:"userForm.userName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户类型",prop:"userType","label-width":e.formLabelWidth}},[r("el-select",{staticStyle:{width:"100%"},model:{value:e.userForm.userType,callback:function(t){e.$set(e.userForm,"userType",t)},expression:"userForm.userType"}},[r("el-option",{attrs:{label:"部门",value:"2"}}),e._v(" "),r("el-option",{attrs:{label:"单位",value:"1"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"用户状态","label-width":e.formLabelWidth,prop:"userStatus"}},[r("el-radio-group",{model:{value:e.userForm.userStatus,callback:function(t){e.$set(e.userForm,"userStatus",t)},expression:"userForm.userStatus"}},[r("el-radio",{attrs:{label:"1"}},[e._v("启用")]),e._v(" "),r("el-radio",{attrs:{label:"0"}},[e._v("禁用")])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"用户邮箱","label-width":e.formLabelWidth,prop:"userEmail"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.userForm.userEmail,callback:function(t){e.$set(e.userForm,"userEmail",t)},expression:"userForm.userEmail"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户电话","label-width":e.formLabelWidth,prop:"userPhone"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.userForm.userPhone,callback:function(t){e.$set(e.userForm,"userPhone",t)},expression:"userForm.userPhone"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.saveUserManage(e.userForm)}}},[e._v("保存")]),e._v(" "),r("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.resetForm("userForm")}}},[e._v("重置")])],1)],1)},staticRenderFns:[]};var n=r("C7Lr")(a,s,!1,function(e){r("8exI")},"data-v-ce24c1d8",null);t.default=n.exports},bC3Y:function(e,t){},hQpW:function(e,t,r){"use strict";var a=r("ZLEe"),s=r.n(a),n=(r("g7ZD"),{name:"OrganizationTreeSelect",props:["defaultOptions"],data:function(){return{selectedOptions:[],treeProps:{value:"id",label:"name",children:"children"},treeList:[],findObject:{}}},created:function(){this.getData()},computed:{},watch:{findObject:function(){this.$refs.refHandle&&(this.$refs.refHandle.dropDownVisible=!1)}},methods:{handleChange:function(e){if(0!==s()(this.selectedOptions).length){var t="";e&&e.length>0&&(t=e[e.length-1]),this.findObjById(this.treeList,t),this.$emit("OrgTreeSelectCall",this.findObject)}else this.$emit("OrgTreeSelectCall","")},findObjById:function(e,t){for(var r=0;r<e.length;r++){if(t==e[r].id)return this.findObject=e[r],void console.log(this.findObject);void 0!=e[r].children&&0!=e[r].children.length&&this.findObjById(e[r].children,t)}},getData:function(){var e=this,t=this;t.$http({url:t.$http.adornUrl(t.API.getOrganizationTree),method:"post",data:t.$http.adornData()}).then(function(r){var a=r.data;if("0"==a.code){t.treeList=t.commonFun.getTreeData(a.data);var s={};t.defaultOptions?(t.selectedOptions=t.defaultOptions,s=e.findObjById(t.treeList,t.defaultOptions)):""==t.defaultOptions?s={}:(t.selectedOptions.push(t.treeList[0].id),s=t.treeList[0]),e.$emit("OrgTreeSelectCall",s)}else t.$message({type:"error",message:"获取区域树形下拉框数据失败，请刷新重试！"})}).catch(function(e){console.log("获取区域树形下拉框数据="+e),t.$message({type:"error",message:"请求异常，请检查网络！"})})}},mounted:function(){}}),i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"organizationTreeSelect"},[r("el-cascader",{ref:"refHandle",attrs:{placeholder:"请选择机构","expand-trigger":"hover",options:e.treeList,"change-on-select":!0,props:e.treeProps,clearable:!0,"show-all-levels":!1,size:"small"},on:{change:e.handleChange},model:{value:e.selectedOptions,callback:function(t){e.selectedOptions=t},expression:"selectedOptions"}})],1)},staticRenderFns:[]};var o=r("C7Lr")(n,i,!1,function(e){r("bC3Y")},"data-v-f776adea",null);t.a=o.exports}});
//# sourceMappingURL=11.a61f5daa74da31efb16c.js.map