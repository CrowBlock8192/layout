webpackJsonprmsh([14,41,85],{"85Ra":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={components:{orgTree:a("HMPb").a},data:function(){return{title:"",roleId:"",visible:!1,activeName:"first",checked:!1,treeData:[],treeCheckBox:!0,defaultChecked:[]}},methods:{init:function(e,t){var a=this;this.visible=!0,this.title=e.roleName,this.roleId=e.roleId,this.$http({url:this.$http.adornUrl(this.API.getSysMenuTree),method:"post",data:this.$http.adornData({areaId:this.$store.state.user.areaId,sysId:t,roleId:e.roleId})}).then(function(e){var t=e.data;t&&0===t.code?(a.treeData=t.data,a.defaultChecked=a.getIsCheckCurrent(t.data)):(a.$message.error(t.msg),a.treeData=[],a.defaultChecked=[])})},getCurrentKey:function(){var e=this;this.$http({url:this.$http.adornUrl(this.API.savaOrUpdateSysMenuTree),method:"post",data:this.$http.adornData({roleId:this.roleId,ids:this.$refs.tree.getCheckedKeys().join(",")})}).then(function(t){var a=t.data;a&&0===a.code?e.$message.success("操作成功"):e.$message.error(a.msg)})},getIsCheckCurrent:function(e){var t=[];if(e){return function e(a){return a.forEach(function(a){a.isCheck&&t.push(a.id),a.children&&a.children.length>0&&e(a.children)}),t}(e)}}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"grant-authorization",attrs:{title:e.title,"close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"功能菜单",name:"first"}},[a("div",{staticClass:"float-right"},[a("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("关联子节点")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.getCurrentKey}},[e._v("保存")])],1),e._v(" "),a("div",{staticClass:"clearfix"}),e._v(" "),a("el-scrollbar",{staticStyle:{height:"400px"}},[a("org-tree",{ref:"tree",attrs:{treeData:e.treeData,checkbox:e.treeCheckBox,checkStrictly:!e.checked,defaultChecked:e.defaultChecked}})],1)],1)],1)],1)},staticRenderFns:[]};var o=a("C7Lr")(r,i,!1,function(e){a("H8Dv")},"data-v-7da8bb89",null);t.default=o.exports},H8Dv:function(e,t){},Ohch:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("X6wn"),i=a("85Ra"),o=a("HMPb"),n=a("NxFF"),s={props:["siteContentViewHeight"],data:function(){return{treeData:[],expandAll:!0,sysId:"",keyWordSearch:"",dataList:[],dataListLoading:!1,dataListSelections:[],addOrUpdateVisible:!1,grantAuthorizationVisible:!1,page:{pageIndex:this.API.constObj.pageIndex,pageSize:this.API.constObj.pageSize,total:0}}},components:{AddOrUpdate:r.default,GrantAuthorization:i.default,pagination:n.a,orgTree:o.a},created:function(){this.getDataTree()},methods:{getDataTree:function(){var e=this;this.$http({url:this.$http.adornUrl(this.API.getRoleMenuTree),method:"post",data:this.$http.adornData({areaId:this.$store.state.user.areaId})}).then(function(t){var a=t.data;if(a&&0===a.code){var r=[];a.data.length>0&&(a.data.forEach(function(e){r.push({name:e.sysName,id:e.sysId})}),e.treeData=[{name:"应用子系统",children:r}],e.orgTreeClick(e.treeData[0].children[0]))}else e.$message.error(a.msg),e.treeData=[]})},orgTreeClick:function(e){this.sysId=e.id,this.getDataList()},getDataList:function(){var e=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl(this.API.getRoleInfo),method:"post",data:this.$http.adornData({sysId:this.sysId,areaId:this.$store.state.user.areaId,current:this.page.pageIndex,pageSize:this.page.pageSize,roleName:this.keyWordSearch})}).then(function(t){var a=t.data;a&&0===a.code?(e.dataList=a.data.records,e.page.total=a.data.total):(e.$message.error(a.msg),e.dataList=[],e.page.total=0),e.dataListLoading=!1})},addOrUpdateHandle:function(e){var t=this;""!=this.sysId?(this.addOrUpdateVisible=!0,this.$nextTick(function(){t.$refs.addOrUpdate.init(e,t.sysId)})):this.$confirm("请选择一个节点","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})},deleteHandle:function(e,t){var a=this;this.$confirm("确定要删除该信息？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http({url:a.$http.adornUrl(a.API.deleteRoleInfo),method:"post",data:a.$http.adornData({roleId:t.roleId,sysId:a.sysId,areaId:a.$store.state.user.areaId,userId:a.$store.state.user.id})}).then(function(t){var r=t.data;r&&0===r.code?(a.dataList.splice(e,1),a.$message.success("操作成功")):a.$message.error(r.msg)})}).catch(function(){})},authorizationHandle:function(e){var t=this;this.grantAuthorizationVisible=!0,this.$nextTick(function(){t.$refs.grantAuthorization.init(e,t.sysId)})},PageTurning:function(e){this.page.pageIndex=e.page_index,this.page.pageSize=e.page_size,this.getDataList()}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"permission-assignment"},[a("el-aside",{attrs:{width:"20%"}},[a("org-tree",{ref:"tree",attrs:{treeData:e.treeData,expandAll:e.expandAll},on:{"node-click":e.orgTreeClick}})],1),e._v(" "),a("el-main",[a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-input",{attrs:{size:"small",placeholder:"请输入角色名称",clearable:""},model:{value:e.keyWordSearch,callback:function(t){e.keyWordSearch=t},expression:"keyWordSearch"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getDataList()}}},[e._v("检索")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addOrUpdateHandle()}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",height:e.siteContentViewHeight-105+"px"}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleCode",width:"200",label:"角色代码"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleType",width:"200",label:"角色类别"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===parseInt(t.row.roleType)?a("div",[e._v("系统管理员")]):e._e(),e._v(" "),2===parseInt(t.row.roleType)?a("div",[e._v("安全保密员")]):e._e(),e._v(" "),3===parseInt(t.row.roleType)?a("div",[e._v("安全审计员")]):e._e(),e._v(" "),4===parseInt(t.row.roleType)?a("div",[e._v("业务管理员")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"roleState",width:"120",label:"角色状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===parseInt(t.row.roleState)?a("el-tag",{attrs:{size:"small",type:"danger"}},[e._v("停用")]):a("el-tag",{attrs:{size:"small"}},[e._v("启用")])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"200",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(a){return e.addOrUpdateHandle(t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini",plain:""},on:{click:function(a){return e.deleteHandle(t.$index,t.row)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{type:"success",size:"mini",plain:""},on:{click:function(a){return e.authorizationHandle(t.row)}}},[e._v("授权")])]}}])})],1),e._v(" "),a("pagination",{attrs:{total:e.page.total,pageSize:e.page.pageSize},on:{PageTurning:e.PageTurning}}),e._v(" "),e.addOrUpdateVisible?a("add-or-update",{ref:"addOrUpdate",on:{refreshDataList:e.getDataList}}):e._e(),e._v(" "),e.grantAuthorizationVisible?a("grant-authorization",{ref:"grantAuthorization"}):e._e()],1)],1)},staticRenderFns:[]};var d=a("C7Lr")(s,l,!1,function(e){a("qCU7")},"data-v-c8f3c48c",null);t.default=d.exports},X6wn:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("aA9S"),i=a.n(r),o={data:function(){return{visible:!1,sysId:"",dataForm:{roleId:0,roleCode:"",roleName:"",roleType:1,roleState:1},dataRule:{roleCode:[{required:!0,message:"角色代码必填",trigger:"blur"}],roleName:[{required:!0,message:"角色名称必填",trigger:"blur"}]},roleType:[{id:1,text:"系统管理员"},{id:2,text:"安全保密员"},{id:3,text:"安全审计员"},{id:4,text:"业务管理员"}]}},methods:{init:function(e,t){var a=this;this.dataForm.roleId=e&&e.roleId||0,this.visible=!0,this.sysId=t,this.$nextTick(function(){a.$refs.dataForm.resetFields(),a.dataForm.roleId&&(a.dataForm.roleCode=e.roleCode,a.dataForm.roleName=e.roleName,a.dataForm.roleType=e.roleType?parseInt(e.roleType):1,a.dataForm.roleState=e.roleState?parseInt(e.roleState):1)})},dataFormSubmit:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){var a={sysId:e.sysId,areaId:e.$store.state.user.areaId};e.dataForm.roleId=e.dataForm.roleId||void 0,i()(a,e.dataForm),e.$http({url:e.$http.adornUrl(e.API.savaOrUpdateRoleInfo),method:"post",data:e.$http.adornData(a)}).then(function(t){var a=t.data;a&&0===a.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.visible=!1,e.$emit("refreshDataList")}}):e.$message.error(a.msg)})}})}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.dataForm.id?"角色修改":"角色新增","close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"100px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmit()}}},[a("el-form-item",{attrs:{label:"角色代码",prop:"roleCode"}},[a("el-input",{model:{value:e.dataForm.roleCode,callback:function(t){e.$set(e.dataForm,"roleCode",t)},expression:"dataForm.roleCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{model:{value:e.dataForm.roleName,callback:function(t){e.$set(e.dataForm,"roleName",t)},expression:"dataForm.roleName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色类别",prop:"roleType"}},[a("el-radio-group",{model:{value:e.dataForm.roleType,callback:function(t){e.$set(e.dataForm,"roleType",t)},expression:"dataForm.roleType"}},e._l(e.roleType,function(t){return a("el-radio",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.text))])}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"角色状态",prop:"roleState"}},[a("el-radio-group",{model:{value:e.dataForm.roleState,callback:function(t){e.$set(e.dataForm,"roleState",t)},expression:"dataForm.roleState"}},[a("el-radio",{attrs:{label:0}},[e._v("停用")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("启用")])],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},staticRenderFns:[]},s=a("C7Lr")(o,n,!1,null,null,null);t.default=s.exports},qCU7:function(e,t){}});
//# sourceMappingURL=14.a160b0c5062ec2a5cb74.js.map