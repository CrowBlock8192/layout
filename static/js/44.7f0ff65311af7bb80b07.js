webpackJsonprmsh([44],{Mb5W:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("aA9S"),s=a.n(i),c=a("HMPb"),n=a("qCR0"),r={props:["siteContentViewHeight"],components:{orgTree:c.a,associationCheckRules:n.default},data:function(){return{treeData:[],activeName:"first",dataListAll:[],dataList:[],dataListLoading:!1,associationCheckRulesVisible:!1,tabId:"",tabName:""}},created:function(){this.getTreeData()},methods:{getTreeData:function(){var t=this;this.$http({url:this.$http.adornUrl(this.API.getPersonDataTableTree),method:"post",data:this.$http.adornData()}).then(function(e){var a=e.data;t.treeData=[],a&&0===a.code?(a.data.forEach(function(e){t.treeData.push({id:e.tabCode,name:e.tabName})}),t.orgTreeClick(t.treeData[0])):t.$message.error(a.msg)})},getDataList:function(){var t=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl(this.API.getRuleList),method:"get",params:this.$http.adornParams({tabId:this.tabId})}).then(function(e){var a=e.data;t.dataList=[],a&&0===a.code?(t.dataListAll=a.data,a.data.forEach(function(e){1==e.isCheck&&t.dataList.push(e)})):(t.$message.error(a.msg),t.dataListAll=[]),t.dataListLoading=!1})},orgTreeClick:function(t){this.tabId=t.id,this.tabName=t.name,this.getDataList()},associationCheckRulesHandle:function(){var t=this;this.associationCheckRulesVisible=!0,this.$nextTick(function(){t.$refs.associationCheckRules.init(t.dataListAll,!1,t.tabId)})},switchChange:function(t,e){var a=this,i={tabId:this.tabId,checkId:e};s()(i,t),this.$http({url:this.$http.adornUrl(this.API.updateDataChecktable),method:"post",data:this.$http.adornData(i)}).then(function(t){var e=t.data;e&&0===e.code?a.$message.success("操作成功"):a.$message.error(e.msg)})}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticClass:"permission-assignment"},[a("el-aside",{staticClass:"permission-assignment-aside",attrs:{width:"20%"}},[a("el-scrollbar",{style:{height:t.siteContentViewHeight-10+"px"}},[a("org-tree",{ref:"tree",attrs:{treeData:t.treeData},on:{"node-click":t.orgTreeClick}})],1)],1),t._v(" "),a("el-main",[a("el-tabs",{attrs:{type:"card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"逻辑条件校验",name:"first"}},[a("div",{staticClass:"permission-assignment-title"},[a("span"),t._v(" "),a("p",[t._v(t._s(t.tabName)+" 共"+t._s(t.dataList.length)+"条记录")])]),t._v(" "),a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.associationCheckRulesHandle}},[t._v("关联函数校验")])],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.dataList,border:"",height:t.siteContentViewHeight-140+"px"}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ruleName",width:"200",label:"规则名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ruleChecksingle",label:"单记录校验"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ruleCheckperson",width:"300",label:"人员校验"}}),t._v(" "),a("el-table-column",{attrs:{prop:"roleState",width:"180",label:"执行阶段"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              保存前："),a("el-switch",{staticClass:"switchStyle",attrs:{"active-value":"1","inactive-value":"0","active-text":"启用","inactive-color":"#e8e4f3","inactive-text":"关闭"},on:{change:function(a){return t.switchChange({checkBefor:a},e.row.checkId)}},model:{value:e.row.checkBefor,callback:function(a){t.$set(e.row,"checkBefor",a)},expression:"scope.row.checkBefor"}}),t._v(" "),a("br"),t._v("\n              保存后："),a("el-switch",{staticClass:"switchStyle",attrs:{"active-value":"1","inactive-value":"0","active-text":"启用","inactive-color":"#e8e4f3","inactive-text":"关闭"},on:{change:function(a){return t.switchChange({checkAfter:a},e.row.checkId)}},model:{value:e.row.checkAfter,callback:function(a){t.$set(e.row,"checkAfter",a)},expression:"scope.row.checkAfter"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"checkStatus",width:"100",label:"启用状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{staticClass:"switchStyle",attrs:{"active-value":"1","inactive-value":"0","active-text":"启用","inactive-color":"#e8e4f3","inactive-text":"未启用"},on:{change:function(a){return t.switchChange({checkStatus:a},e.row.checkId)}},model:{value:e.row.checkStatus,callback:function(a){t.$set(e.row,"checkStatus",a)},expression:"scope.row.checkStatus"}})]}}])})],1)],1)],1),t._v(" "),t.associationCheckRulesVisible?a("association-check-rules",{ref:"associationCheckRules",on:{refreshDataList:t.getDataList}}):t._e()],1)],1)},staticRenderFns:[]};var l=a("C7Lr")(r,o,!1,function(t){a("zFCI")},"data-v-7884c538",null);e.default=l.exports},zFCI:function(t,e){}});
//# sourceMappingURL=44.7f0ff65311af7bb80b07.js.map