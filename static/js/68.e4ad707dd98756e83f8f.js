webpackJsonprmsh([68],{S1XS:function(e,t){},WprJ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("lQQE"),n={name:"orgFileUpload",props:{orgCode:{type:String},labelNames:{type:String}},components:{orgFilePreview:o.default},data:function(){return{tableData:[],fileData:new FormData,multipleSelection:[]}},computed:{},watch:{},methods:{selectAttachment:function(){var e=this;if(""!=e.orgCode){var t={b0111:e.orgCode};e.$axios.post(e.$api.org.selectAttachmentByB0111,t).then(function(t){if(0===t.data.code){var a=t.data;e.tableData=a.data}else e.$message.error(t.data.msg)})}},handleDelete:function(e,t){var a=this,o=this;o.$confirm("是否确认此操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.$axios.post(o.$api.org.deleteAttachmentById,t).then(function(e){0===e.data.code?(o.$message.success(e.data.msg),o.selectAttachment()):o.$message.error(e.data.msg)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},uploadFile:function(e){this.fileData.append("files",e.file)},submitUpload:function(){var e=this;e.$refs.upload.submit(),e.fileData.append("orgCode",e.orgCode);e.$axios.post(e.$api.org.uplodeB01Attachment,this.fileData,{headers:{"Content-Type":"multipart/form-data"},transformRequest:[function(e){return e}]}).then(function(t){0===t.data.code?(e.$message({message:"上传成功",type:"success"}),e.$refs.upload.clearFiles(),e.fileData=new FormData,e.selectAttachment()):(e.fileData.delete("orgCode"),e.$message({message:"上传失败，请重试",type:"error"}))})},downLoadFile:function(e,t){this.$axios({url:this.$api.org.downloadB01Attachment,data:t,method:"post",responseType:"blob"}).then(function(e){var a=new Blob([e.data]);if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(a,t.fileName);else{var o=document.createElement("a");o.href=window.URL.createObjectURL(a),o.download=t.fileName,o.click(),window.URL.revokeObjectURL(o.href)}})},handleEdit:function(e,t){this.$refs.changePreview.previewPdf(t)},handleSelectionChange:function(e){this.multipleSelection=e}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"orgFile"},[a("div",{staticClass:"fileTitle"},[a("span",{staticClass:"explain"},[a("i",{staticClass:"el-icon-more"}),e._v("\n    "+e._s(e.labelNames)+"\n  ")]),e._v(" "),a("div",{staticClass:"upload-container"},[a("el-upload",{ref:"upload",staticClass:"upload",attrs:{multiple:"",action:"","auto-upload":!1,"http-request":e.uploadFile}},[a("el-button",{attrs:{slot:"trigger",size:"mini",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary"},on:{click:e.submitUpload}},[e._v("上传到服务器\n                ")])],1)],1)]),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"序号",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"fileName",label:"文件名称",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"摘要","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"fileSize",label:"文件大小","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"uploadTime",label:"上传时间","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{icon:"el-icon-view",size:"mini",type:"primary",title:"预览",circle:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{size:"mini",icon:"el-icon-close-solid",title:"删除",circle:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{size:"mini",icon:"el-icon-download",type:"primary",title:"下载",circle:""},on:{click:function(a){return e.downLoadFile(t.$index,t.row)}}})]}}])})],1),e._v(" "),a("org-file-preview",{ref:"changePreview"})],1)},staticRenderFns:[]};var l=a("C7Lr")(n,i,!1,function(e){a("S1XS")},"data-v-35c9c0ea",null);t.default=l.exports}});
//# sourceMappingURL=68.e4ad707dd98756e83f8f.js.map